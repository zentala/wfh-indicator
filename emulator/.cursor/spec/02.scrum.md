# Device Mock - Scrum Plan Implementation

## ğŸ¯ Cel Projektu

Implementacja mocka urzÄ…dzenia LED dla aplikacji WFH Indicator, ktÃ³ry bÄ™dzie symulowaÅ‚ zachowanie prawdziwego urzÄ…dzenia ESP32 + WS2812B LED ring. Mock bÄ™dzie uÅ¼ywany do testowania komunikacji miÄ™dzy tray app a urzÄ…dzeniem bez potrzeby posiadania prawdziwego hardware.

## ğŸ“‹ Sprint Overview

| Sprint   | Cel                                             | Czas trwania | Status    |
| -------- | ----------------------------------------------- | ------------ | --------- |
| Sprint 1 | Budowanie emulatora - podstawowa infrastruktura | 1 tydzieÅ„    | Planowany |
| Sprint 2 | Budowanie emulatora - LED simulation            | 1 tydzieÅ„    | Planowany |
| Sprint 3 | Budowanie emulatora - WiFi communication        | 1 tydzieÅ„    | Planowany |
| Sprint 4 | Integracja z tray app                           | 1 tydzieÅ„    | Planowany |
| Sprint 5 | Zaawansowane funkcje i optymalizacja            | 1 tydzieÅ„    | Planowany |

---

## Sprint 1: Budowanie Emulatora - Podstawowa Infrastruktura

**Cel Sprintu:** Stworzenie podstawowej infrastruktury projektu emulatora.

### Epik: Project Setup & Core Infrastructure

#### **Task 1.1: Inicjalizacja projektu emulatora** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Stworzenie podstawowej struktury projektu emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie struktury folderÃ³w emulatora
- [ ] Konfiguracja TypeScript dla emulatora
- [ ] Konfiguracja pnpm dla emulatora
- [ ] Konfiguracja ESLint + Prettier dla emulatora
- [ ] Konfiguracja Jest dla emulatora
- [ ] Utworzenie package.json z zaleÅ¼noÅ›ciami dla emulatora

**Kryteria ukoÅ„czenia:**
- [ ] Projekt emulatora siÄ™ buduje bez bÅ‚Ä™dÃ³w
- [ ] ESLint przechodzi bez bÅ‚Ä™dÃ³w
- [ ] Jest uruchamia siÄ™ poprawnie
- [ ] TypeScript compilation dziaÅ‚a

#### **Task 1.2: Implementacja Device Types** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Definicje typÃ³w TypeScript dla emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie `src/types/deviceTypes.ts`
- [ ] WorkStatus enum
- [ ] LEDPattern interface
- [ ] WiFiCredentials interface
- [ ] DeviceInfo interface
- [ ] Message interfaces (WebSocket)

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie typy sÄ… zdefiniowane
- [ ] TypeScript compilation bez bÅ‚Ä™dÃ³w
- [ ] JSDoc dla wszystkich typÃ³w

#### **Task 1.3: Implementacja Color Utils** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** NarzÄ™dzia do konwersji kolorÃ³w dla emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie `src/utils/colorUtils.ts`
- [ ] Funkcje konwersji RGB â†” HEX
- [ ] Funkcje konwersji status â†’ color
- [ ] Funkcje brightness adjustment
- [ ] Funkcje color validation

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie funkcje konwersji dziaÅ‚ajÄ…
- [ ] Testy jednostkowe dla color utils
- [ ] ObsÅ‚uga bÅ‚Ä™dÃ³w dla nieprawidÅ‚owych kolorÃ³w

#### **Task 1.4: Implementacja Serial Utils** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Symulacja komunikacji szeregowej dla emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie `src/utils/serialUtils.ts`
- [ ] Symulacja SerialPort
- [ ] Funkcje read/write
- [ ] Data encoding/decoding
- [ ] Error simulation

**Kryteria ukoÅ„czenia:**
- [ ] Serial communication dziaÅ‚a
- [ ] Data encoding/decoding dziaÅ‚a
- [ ] Error simulation dziaÅ‚a
- [ ] Testy jednostkowe dla serial utils

#### **Task 1.5: Testy jednostkowe dla podstawowej infrastruktury** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Pokrycie testami podstawowej infrastruktury emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Testy dla Device Types
- [ ] Testy dla Color Utils
- [ ] Testy dla Serial Utils
- [ ] Mocki dla zaleÅ¼noÅ›ci

**Kryteria ukoÅ„czenia:**
- [ ] Pokrycie testami >80%
- [ ] Wszystkie testy przechodzÄ…
- [ ] Testy dla edge cases

---

## Sprint 2: Budowanie Emulatora - LED Simulation

**Cel Sprintu:** Implementacja symulacji LED ring w emulatorze.

### Epik: LED Controller & Animation

#### **Task 2.1: Implementacja LED Controller** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Symulacja LED ring z kolorami statusÃ³w

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie `src/main/ledController.ts`
- [ ] Implementacja enum WorkStatus
- [ ] Implementacja LEDPattern interface
- [ ] Funkcje setColor(), setBrightness(), setPattern()
- [ ] Symulacja animacji (breathing, pulse, blink)
- [ ] Console output dla wizualizacji LED

**Kryteria ukoÅ„czenia:**
- [ ] LED Controller obsÅ‚uguje wszystkie kolory statusÃ³w
- [ ] Animacje dziaÅ‚ajÄ… poprawnie
- [ ] Console output pokazuje stan LED
- [ ] Testy jednostkowe dla LED Controller

#### **Task 2.2: Implementacja LED Patterns** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Zaawansowane wzory animacji LED

**SzczegÃ³Å‚y implementacji:**
- [ ] Breathing pattern implementation
- [ ] Pulse pattern implementation
- [ ] Blink pattern implementation
- [ ] Solid pattern implementation
- [ ] Pattern transitions
- [ ] Speed control

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie wzory animacji dziaÅ‚ajÄ…
- [ ] Transitions miÄ™dzy wzorami dziaÅ‚ajÄ…
- [ ] Speed control dziaÅ‚a
- [ ] Testy jednostkowe dla patterns

#### **Task 2.3: Implementacja Button Handler** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Symulacja przycisku fizycznego w emulatorze

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie `src/main/buttonHandler.ts`
- [ ] Single press (Ask to Enter)
- [ ] Long press (Reset/Pairing mode)
- [ ] Double press (Toggle brightness)
- [ ] Visual feedback
- [ ] Debouncing

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie typy przyciskÃ³w dziaÅ‚ajÄ…
- [ ] Visual feedback dziaÅ‚a
- [ ] Debouncing dziaÅ‚a
- [ ] Testy jednostkowe dla button handler

#### **Task 2.4: Integracja LED z Button** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Integracja LED Controller z Button Handler

**SzczegÃ³Å‚y implementacji:**
- [ ] LED feedback dla przyciskÃ³w
- [ ] Brightness control przez przyciski
- [ ] Pattern changes przez przyciski
- [ ] Visual indicators

**Kryteria ukoÅ„czenia:**
- [ ] LED feedback dziaÅ‚a dla wszystkich przyciskÃ³w
- [ ] Brightness control dziaÅ‚a
- [ ] Pattern changes dziaÅ‚ajÄ…
- [ ] Testy integracyjne

#### **Task 2.5: Testy jednostkowe dla LED system** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Pokrycie testami systemu LED

**SzczegÃ³Å‚y implementacji:**
- [ ] Testy dla LED Controller
- [ ] Testy dla LED Patterns
- [ ] Testy dla Button Handler
- [ ] Testy integracyjne LED + Button

**Kryteria ukoÅ„czenia:**
- [ ] Pokrycie testami >90%
- [ ] Wszystkie testy przechodzÄ…
- [ ] Testy dla edge cases

---

## Sprint 3: Budowanie Emulatora - WiFi Communication

**Cel Sprintu:** Implementacja komunikacji WiFi i WebSocket server w emulatorze.

### Epik: WiFi Communication & WebSocket Server

#### **Task 3.1: Implementacja WebSocket Server** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Serwer WebSocket do komunikacji z tray app

**SzczegÃ³Å‚y implementacji:**
- [ ] Utworzenie `src/main/wifiManager.ts`
- [ ] Implementacja WebSocket server
- [ ] ObsÅ‚uga poÅ‚Ä…czeÅ„ klientÃ³w
- [ ] Message routing
- [ ] Error handling

**Kryteria ukoÅ„czenia:**
- [ ] WebSocket server uruchamia siÄ™ na porcie 8080
- [ ] ObsÅ‚uguje poÅ‚Ä…czenia z tray app
- [ ] Loguje poÅ‚Ä…czenia i bÅ‚Ä™dy
- [ ] Testy jednostkowe dla WebSocket

#### **Task 3.2: Implementacja Message Handlers** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** ObsÅ‚uga wiadomoÅ›ci WebSocket w emulatorze

**SzczegÃ³Å‚y implementacji:**
- [ ] StatusUpdate handler
- [ ] AskToEnterRequest handler
- [ ] AskToEnterResponse handler
- [ ] BatteryReport handler
- [ ] Message validation

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie typy wiadomoÅ›ci sÄ… obsÅ‚ugiwane
- [ ] Walidacja wiadomoÅ›ci dziaÅ‚a
- [ ] Error handling dla nieprawidÅ‚owych wiadomoÅ›ci
- [ ] Testy jednostkowe dla message handlers

#### **Task 3.3: Integracja LED z WebSocket** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Aktualizacja LED na podstawie wiadomoÅ›ci WebSocket

**SzczegÃ³Å‚y implementacji:**
- [ ] Integracja LED Controller z WebSocket
- [ ] Automatyczna aktualizacja LED przy status update
- [ ] Visual feedback dla ask to enter
- [ ] Battery level indication

**Kryteria ukoÅ„czenia:**
- [ ] LED zmienia kolor przy status update
- [ ] Visual feedback dla ask to enter dziaÅ‚a
- [ ] Battery level jest wyÅ›wietlany
- [ ] Testy integracyjne

#### **Task 3.4: Implementacja Battery Simulation** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Symulacja poziomu baterii w emulatorze

**SzczegÃ³Å‚y implementacji:**
- [ ] Symulacja poziomu baterii (0-100%)
- [ ] Automatyczne zmniejszanie poziomu
- [ ] Raportowanie co 5 minut
- [ ] Charging state simulation

**Kryteria ukoÅ„czenia:**
- [ ] Battery level jest symulowany
- [ ] Raporty sÄ… wysyÅ‚ane co 5 minut
- [ ] Charging state dziaÅ‚a
- [ ] Testy jednostkowe dla battery simulation

#### **Task 3.5: Testy integracyjne WebSocket** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Testy komunikacji WebSocket w emulatorze

**SzczegÃ³Å‚y implementacji:**
- [ ] Testy poÅ‚Ä…czenia WebSocket
- [ ] Testy wysyÅ‚ania wiadomoÅ›ci
- [ ] Testy odbierania wiadomoÅ›ci
- [ ] Testy error handling

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie testy integracyjne przechodzÄ…
- [ ] Testy dla rÃ³Å¼nych scenariuszy bÅ‚Ä™dÃ³w
- [ ] Performance tests

---

## Sprint 4: Integracja z Tray App

**Cel Sprintu:** Integracja emulatora z testami E2E w tray-app.

### Epik: E2E Integration & Testing

#### **Task 4.1: Implementacja Test Mode** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Tryb testowy dla emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Test mode flag
- [ ] Test controller API
- [ ] Simplified communication
- [ ] Test scenarios
- [ ] Mock reset functionality

**Kryteria ukoÅ„czenia:**
- [ ] Test mode dziaÅ‚a
- [ ] API do kontrolowania emulatora dziaÅ‚a
- [ ] Mock reset dziaÅ‚a
- [ ] Testy dla test mode

#### **Task 4.2: Mock Controller API** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** API do kontrolowania emulatora w testach

**SzczegÃ³Å‚y implementacji:**
- [ ] pressButton() method
- [ ] receiveSerialData() method
- [ ] sendAskToEnterRequest() method
- [ ] getLEDStatus() method
- [ ] getLastResponse() method

**Kryteria ukoÅ„czenia:**
- [ ] Wszystkie metody API dziaÅ‚ajÄ…
- [ ] API jest dobrze udokumentowane
- [ ] Testy jednostkowe dla API
- [ ] JSDoc dla wszystkich metod

#### **Task 4.3: Integracja z Playwright** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Integracja z testami Playwright w tray-app

**SzczegÃ³Å‚y implementacji:**
- [ ] Mock helper dla Playwright
- [ ] Setup/teardown functions
- [ ] Device action simulation
- [ ] Response verification
- [ ] Error handling

**Kryteria ukoÅ„czenia:**
- [ ] Mock helper dziaÅ‚a z Playwright
- [ ] Setup/teardown dziaÅ‚a
- [ ] Device actions sÄ… symulowane
- [ ] Testy integracyjne z Playwright

#### **Task 4.4: Test Parowania (Task 4.15)** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Test E2E dla procesu parowania z emulatorem

**SzczegÃ³Å‚y implementacji:**
- [ ] Test complete pairing flow
- [ ] Mock device simulation
- [ ] Tray app interaction
- [ ] Verification steps
- [ ] Error scenarios

**Kryteria ukoÅ„czenia:**
- [ ] Test parowania przechodzi
- [ ] Mock symuluje urzÄ…dzenie
- [ ] Tray app interaction dziaÅ‚a
- [ ] Verification dziaÅ‚a
- [ ] Error scenarios sÄ… testowane

#### **Task 4.5: Test Ask to Enter (Task 6.7)** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Test E2E dla "Ask to Enter" z emulatorem

**SzczegÃ³Å‚y implementacji:**
- [ ] Test ask to enter flow
- [ ] Notification verification
- [ ] Response handling
- [ ] Different urgency levels
- [ ] Error scenarios

**Kryteria ukoÅ„czenia:**
- [ ] Test ask to enter przechodzi
- [ ] Notifications sÄ… weryfikowane
- [ ] Response handling dziaÅ‚a
- [ ] Different urgency levels sÄ… testowane
- [ ] Error scenarios sÄ… testowane

---

## Sprint 5: Zaawansowane Funkcje i Optymalizacja

**Cel Sprintu:** Zaawansowane funkcje, optymalizacja i dokumentacja emulatora.

### Epik: Advanced Features & Optimization

#### **Task 5.1: Multiple Device Support** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** ObsÅ‚uga wielu urzÄ…dzeÅ„ w emulatorze

**SzczegÃ³Å‚y implementacji:**
- [ ] Multiple device instances
- [ ] Device identification
- [ ] Independent state management
- [ ] Device-specific configurations
- [ ] Load balancing

**Kryteria ukoÅ„czenia:**
- [ ] Multiple devices sÄ… obsÅ‚ugiwane
- [ ] Device identification dziaÅ‚a
- [ ] Independent state management dziaÅ‚a
- [ ] Testy dla multiple devices

#### **Task 5.2: Performance Optimization** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Optymalizacja wydajnoÅ›ci emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] Memory usage optimization
- [ ] CPU usage optimization
- [ ] Network latency reduction
- [ ] Efficient message handling
- [ ] Resource cleanup

**Kryteria ukoÅ„czenia:**
- [ ] Memory usage jest zoptymalizowane
- [ ] CPU usage jest zoptymalizowane
- [ ] Network latency jest zredukowane
- [ ] Performance tests przechodzÄ…

#### **Task 5.3: Error Handling & Recovery** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Zaawansowane error handling w emulatorze

**SzczegÃ³Å‚y implementacji:**
- [ ] Network error recovery
- [ ] Serial communication errors
- [ ] Device state recovery
- [ ] Automatic retry mechanisms
- [ ] Error logging

**Kryteria ukoÅ„czenia:**
- [ ] Error recovery dziaÅ‚a
- [ ] Automatic retry dziaÅ‚a
- [ ] Error logging dziaÅ‚a
- [ ] Testy dla error scenarios

#### **Task 5.4: CI/CD Integration** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Integracja z CI/CD dla emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] GitHub Actions workflow
- [ ] Automated testing
- [ ] Build automation
- [ ] Deployment scripts
- [ ] Environment configuration

**Kryteria ukoÅ„czenia:**
- [ ] CI/CD pipeline dziaÅ‚a
- [ ] Automated testing dziaÅ‚a
- [ ] Build automation dziaÅ‚a
- [ ] Deployment scripts dziaÅ‚ajÄ…

#### **Task 5.5: Documentation & Examples** ğŸ“‹ ÅšREDNI PRIORYTET
**Cel:** Kompletna dokumentacja emulatora

**SzczegÃ³Å‚y implementacji:**
- [ ] API documentation
- [ ] Usage examples
- [ ] Integration guide
- [ ] Troubleshooting guide
- [ ] Video tutorials

**Kryteria ukoÅ„czenia:**
- [ ] API documentation jest kompletna
- [ ] Usage examples dziaÅ‚ajÄ…
- [ ] Integration guide jest jasny
- [ ] Troubleshooting guide jest pomocny

---

## Sprint 6: Emulator UI & Error Simulation

**Cel Sprintu:** WdroÅ¼enie ulepszeÅ„ zdefiniowanych w `07.enhancements.md`, aby podnieÅ›Ä‡ wartoÅ›Ä‡ emulatora jako narzÄ™dzia deweloperskiego.

### Epik: Developer Experience Enhancements

#### **Task 6.1: Implementacja wizualizacji UI** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Stworzenie prostego interfejsu webowego dla emulatora.
- [ ] Zintegrowanie serwera HTTP do serwowania `index.html`.
- [ ] Stworzenie pliku `public/index.html` z wizualizacjÄ… LED ring i przyciskiem.
- [ ] Implementacja logiki WebSocket po stronie klienta (JS) do aktualizacji UI.

#### **Task 6.2: Implementacja API do symulacji bÅ‚Ä™dÃ³w** ğŸ”¥ WYSOKI PRIORYTET
**Cel:** Rozszerzenie `TestController` o metody do symulacji awarii.
- [ ] Implementacja `simulateDisconnect()`.
- [ ] Implementacja `simulatePairingError()`.
- [ ] Implementacja `simulateBatteryDrop()`.
- [ ] Implementacja `simulateTimeout()`.
- [ ] Dodanie testÃ³w jednostkowych dla nowych metod kontrolera.

---

## Sprint 7: Refinement & Documentation

**Cel Sprintu:** Finalne szlify, optymalizacja i uzupeÅ‚nienie dokumentacji.

### Epik: Final Polish

#### **Task 7.1: Refaktoryzacja i przeglÄ…d kodu**
#### **Task 7.2: UzupeÅ‚nienie dokumentacji JSDoc i README**

---

## ğŸ“Š Metryki Sukcesu

### Technical Metrics
- **Test Coverage**: >90% dla core functionality
- **Performance**: <100ms response time dla status updates
- **Reliability**: 99.9% uptime podczas testing sessions
- **Compatibility**: Works z current tray app bez modyfikacji

### Development Metrics
- **Code Quality**: ESLint score >95%
- **Documentation**: JSDoc coverage dla wszystkich public APIs
- **Maintainability**: Clear separation of concerns, modular design

---

## ğŸš€ Definition of Done

### Dla kaÅ¼dego taska:
- [ ] Kod jest napisany i dziaÅ‚a
- [ ] Testy jednostkowe przechodzÄ…
- [ ] Testy integracyjne przechodzÄ… (jeÅ›li applicable)
- [ ] Code review jest zakoÅ„czony
- [ ] Dokumentacja jest zaktualizowana
- [ ] JSDoc jest dodany dla public APIs

### Dla kaÅ¼dego sprintu:
- [ ] Wszystkie taski sÄ… ukoÅ„czone
- [ ] Sprint review jest przeprowadzony
- [ ] Retrospective jest przeprowadzony
- [ ] NastÄ™pny sprint jest zaplanowany

---

## ğŸ“ Uwagi dla ProgramistÃ³w

### WaÅ¼ne Uwagi
1. **Test Mode** - Emulator ma specjalny tryb dla testÃ³w E2E
2. **Port Configuration** - Emulator uÅ¼ywa portu 8080 dla WebSocket
3. **Error Handling** - Wszystkie bÅ‚Ä™dy muszÄ… byÄ‡ obsÅ‚ugiwane
4. **Documentation** - KaÅ¼da funkcja musi mieÄ‡ JSDoc

### Debugging
```typescript
// WÅ‚Ä…cz debug mode
const mockDevice = new DeviceMock({
  debug: true,
  testMode: true
});

// SprawdÅº logi
mockDevice.onLog((message: string) => {
  console.log(`[Mock] ${message}`);
});
```

---

**Note**: Ten plan zapewnia systematyczne wdroÅ¼enie emulatora urzÄ…dzenia z moÅ¼liwoÅ›ciÄ… Å›ledzenia postÄ™pu i ukoÅ„czenia wszystkich wymaganych funkcjonalnoÅ›ci.
